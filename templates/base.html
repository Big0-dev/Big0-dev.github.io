<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="{{ meta_des | safe }}" />
    {% if base_tag %} {{ base_tag | safe }} {% endif %} {{ canonical | safe }}
    <title>{{ title | safe }}</title>
    {% if preload %}
    <link
      rel="preload"
      as="image"
      href="{{ static | safe }}/{{ preload | safe }}-mini.avif"
      type="image/avif"
      media="(max-width: 767px)"
    />
    <link
      rel="preload"
      as="image"
      href="{{ static | safe }}/{{ preload | safe }}.avif"
      type="image/avif"
      media="(min-width: 768px)"
    />
    {% endif %}

    <link
      rel="preload"
      href="{{ static | safe }}/Exo2-Regular.woff2"
      as="font"
      type="font/woff2"
      crossorigin="anonymous"
    />

    <link rel="stylesheet" href="{{ static | safe }}/base.css" />

    {% if custom_css %}
        <link rel="stylesheet" href="{{ static | safe }}/{{ custom_css }}.css"/>
    {% endif %}

    <link
      class="favicon"
      rel="icon"
      type="image/svg+xml"
      href="{{ static | safe }}/favicon.svg"
    />
    <script src="{{ static | safe }}/minisearch@7.1.2.min.js"></script>
    <script src="{{ static | safe }}/search.js" defer></script>

    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-5BCYEF9S7N"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
      gtag("config", "G-5BCYEF9S7N");
    </script>
    <script type="text/javascript">
    (function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "sbshmbsh9d");
    </script>
  </head>

  <body>
    <header>
      <nav class="siteHeader">
        <div class="siteHeaderLeft">
          <a href="{{ home }}" aria-label="Home">
            {{ inject_svg('big0_logo', True, 'logo') | safe }}
          </a>
        </div>
        <button
          class="hamburger-btn"
          popovertarget="sideMenuPopover"
          popovertargetaction="toggle"
          aria-label="Open menu"
        >
          <span class="hamburger-line"></span>
          <span class="hamburger-line"></span>
          <span class="hamburger-line"></span>
        </button>

        <div popover="manual" id="sideMenuPopover" class="side-menu-popover">
          <div class="side-menu-container">
            <div class="popover-header">
              <button
                class="close-btn"
                popovertarget="sideMenuPopover"
                popovertargetaction="hide"
                aria-label="Close menu"
              >
                <span class="close-line"></span>
                <span class="close-line"></span>
              </button>
            </div>

            <ul class="popover-menu">
              <li><a href="{{ home }}" aria-label="Home">Home</a></li>
              <li><a href="{{ about }}" aria-label="About Us">About Us</a></li>
              <li><a href="{{ services_page }}" aria-label="Services">Services</a></li>
              <li><a href="{{ blog }}" aria-label="Insights">Insights</a></li>
              <li><a href="{{ case_studies }}" aria-label="Case Studies">Case Studies</a></li>
              <li><a href="{{ careers }}" aria-label="Careers">Careers</a></li>
              <li>
                <a href="{{ contact }}" aria-label="Contact">Contact</a>
              </li>
              <li>
                <button class="search-button" popovertarget="search-box">
                  {{ inject_svg('search_icon', True, 'search-icon') | safe }}
                </button>
              </li>
            </ul>
          </div>
        </div>
        <div class="siteHeaderCenter desktop-menu">
          <ul>
            <li><a href="{{ home }}" aria-label="Home">Home</a></li>
            <li><a href="{{ about }}" aria-label="About Us">About Us</a></li>
            <li><a href="{{ services_page }}" aria-label="Services">Services</a></li>
            <li><a href="{{ blog }}" aria-label="Insights">Insights</a></li>
            <li><a href="{{ case_studies }}" aria-label="Case Studies">Case Studies</a></li>
            <li><a href="{{ careers }}" aria-label="Careers">Careers</a></li>
          </ul>
        </div>
        <div class="siteHeaderRight desktop-menu">
          <a href="{{ contact }}" class="cta-button" aria-label="Get in Touch">
            Get in Touch
          </a>
          <button
            aria-label="Search"
            class="search-button"
            popovertarget="search-box"
          >
            {{ inject_svg('search_icon', True, 'search-icon') | safe }}
          </button>
        </div>
      </nav>

      <div id="search-box" popover="manual" class="search-popover">
        <div class="search-container">
          <div class="search-header">
            <h2>Search</h2>
            <button
              class="close-btn"
              popovertarget="search-box"
              aria-label="Close search"
            >
              <span class="close-line"></span>
              <span class="close-line"></span>
            </button>
          </div>
          <form id="search-form">
            <div class="search-input-container">
              <input
                type="text"
                id="search-input"
                name="q"
                placeholder="Search insights, services, resources..."
                aria-label="Search input"
                autocomplete="off"
                required
              />
              <button
                type="submit"
                class="search-submit"
                aria-label="Submit search"
              >
                {{ inject_svg('search_icon', True, 'search-submit-icon') | safe }}
              </button>
            </div>
          </form>

          <div id="search-results-container" class="search-results-container">
            <div id="search-results" class="search-results"></div>
          </div>
        </div>
      </div>
    </header>

    <main>{{ content | safe }}</main>

    <footer class="siteFooter">
      <div class="footerContent">
        <div class="footerTop">
          <div class="footerLogo">
              
          <a href="{{ home }}" aria-label="Home">
              {{ inject_svg('big0_logo', True, 'footer-logo') | safe }} </a>

            <p class="tagline">Next Level Innovation<br>Powered by Intelligence</p>
          </div>
          <div class="footerColumns">
            <div class="footerColumn">
              <h3>Company</h3>
              <ul>
                <li><a href="{{ about }}">About Us</a></li>
                <li><a href="{{ careers }}">Careers</a></li>
                <li><a href="{{ contact }}">Contact</a></li>
              </ul>
            </div>
            <div class="footerColumn">
              <h3>Services</h3>
              <ul>
                <li><a href="{{ services_page }}">Our Services</a></li>
                <li><a href="{{ industries }}">Industries</a></li>
                <li><a href="{{ partners }}">Partners</a></li>
              </ul>
            </div>
            <div class="footerColumn">
              <h3>Resources</h3>
              <ul>
                <li><a href="{{ blog }}">Insights</a></li>
                <li><a href="{{ case_studies }}">Case Studies</a></li>
                <li><a href="{{ products }}">Products</a></li>
              </ul>
            </div>
            <div class="footerColumn">
              <h3>Support</h3>
              <ul>
                <li><a href="{{ gallery }}">Gallery</a></li>
                <li><a href="{{ news }}">News</a></li>
                <li><a href="{{ sitemap }}">Sitemap</a></li>
              </ul>
            </div>
            <div class="footerColumn">
              <h3>Legal</h3>
              <ul>
                <li><a href="{{ privacy }}">Privacy Policy</a></li>
                <li><a href="{{ terms }}">Terms of Service</a></li>
                <li><a href="{{ image_sitemap }}">Image Sitemap</a></li>
              </ul>
            </div>
          </div>
        </div>
        <div class="footerBottom">
          <div class="footerCopyright">
            <p>&#169; {{ copyright }} Big0 Dev Private Limited. All rights reserved.</p>
          </div>
          <div class="footerSocial">
            <a 
              href="https://linkedin.com/company/big0" 
              aria-label="Follow us on LinkedIn" 
              target="_blank"
              rel="noopener noreferrer"
            >
              {{ inject_svg('linkedin', True) | safe }}
            </a>
            <a 
              href="https://github.com/Big0-dev" 
              aria-label="Visit our GitHub" 
              target="_blank"
              rel="noopener noreferrer"
            >
              {{ inject_svg('github', True) | safe }}
            </a>
            <a 
              href="https://www.youtube.com/@big0_dev" 
              aria-label="Subscribe to our YouTube channel" 
              target="_blank"
              rel="noopener noreferrer"
            >
              {{ inject_svg('youtube', True) | safe }}
            </a>
          </div>
        </div>
      </div>
    </footer>

    <script>
      // Enhanced popover management with click-outside functionality
      document.addEventListener('DOMContentLoaded', function() {
        // Get popover elements
        const searchPopover = document.getElementById('search-box');
        const sideMenuPopover = document.getElementById('sideMenuPopover');
        const searchButtons = document.querySelectorAll('button[popovertarget="search-box"]');
        const menuButtons = document.querySelectorAll('button[popovertarget="sideMenuPopover"]');

        // Track popover states manually since :popover-open might not be supported everywhere
        let isSearchOpen = false;
        let isSideMenuOpen = false;

        // Function to close popover safely
        function closePopover(popover, stateVar) {
          try {
            if (popover && typeof popover.hidePopover === 'function') {
              popover.hidePopover();
            }
          } catch (e) {
            // Fallback: remove open attribute or hide with CSS
            if (popover) {
              popover.style.display = 'none';
            }
          }
        }

        // Listen for popover events to track state
        if (searchPopover) {
          searchPopover.addEventListener('toggle', function(e) {
            isSearchOpen = e.newState === 'open';
          });
        }

        if (sideMenuPopover) {
          sideMenuPopover.addEventListener('toggle', function(e) {
            isSideMenuOpen = e.newState === 'open';
          });
        }

        // Main click handler for outside clicks - using multiple event types
        function handleOutsideClick(event) {
          // Handle search popover
          if (isSearchOpen && searchPopover) {
            const clickedInsideSearch = searchPopover.contains(event.target);
            const clickedSearchButton = Array.from(searchButtons).some(btn => 
              btn.contains(event.target) || btn === event.target
            );
            
            // Also check if clicked on the popover backdrop
            const isBackdropClick = event.target === searchPopover;
            
            if ((!clickedInsideSearch && !clickedSearchButton) || isBackdropClick) {
              closePopover(searchPopover);
              isSearchOpen = false;
            }
          }

          // Handle side menu popover
          if (isSideMenuOpen && sideMenuPopover) {
            const clickedInsideMenu = sideMenuPopover.contains(event.target);
            const clickedMenuButton = Array.from(menuButtons).some(btn => 
              btn.contains(event.target) || btn === event.target
            );
            
            // Also check if clicked on the popover backdrop
            const isBackdropClick = event.target === sideMenuPopover;
            
            if ((!clickedInsideMenu && !clickedMenuButton) || isBackdropClick) {
              closePopover(sideMenuPopover);
              isSideMenuOpen = false;
            }
          }
        }

        // Listen for both click and mousedown events
        document.addEventListener('click', handleOutsideClick, true);
        document.addEventListener('mousedown', handleOutsideClick, true);
        
        // Also listen for clicks directly on the popovers (backdrop)
        if (searchPopover) {
          searchPopover.addEventListener('click', function(event) {
            if (event.target === searchPopover) {
              closePopover(searchPopover);
              isSearchOpen = false;
            }
          });
        }
        
        if (sideMenuPopover) {
          sideMenuPopover.addEventListener('click', function(event) {
            if (event.target === sideMenuPopover) {
              closePopover(sideMenuPopover);
              isSideMenuOpen = false;
            }
          });
        }

        // Handle escape key
        document.addEventListener('keydown', function(event) {
          if (event.key === 'Escape') {
            if (isSearchOpen) {
              closePopover(searchPopover);
              isSearchOpen = false;
            }
            if (isSideMenuOpen) {
              closePopover(sideMenuPopover);
              isSideMenuOpen = false;
            }
          }
        });

        // Close sidebar when clicking on navigation links
        if (sideMenuPopover) {
          const sideMenuLinks = sideMenuPopover.querySelectorAll('a[href]');
          sideMenuLinks.forEach(link => {
            link.addEventListener('click', function() {
              setTimeout(() => {
                closePopover(sideMenuPopover);
                isSideMenuOpen = false;
              }, 100);
            });
          });
        }

        // Auto-focus search input when search opens
        searchButtons.forEach(button => {
          button.addEventListener('click', function() {
            setTimeout(() => {
              if (isSearchOpen) {
                const searchInput = document.getElementById('search-input');
                if (searchInput) {
                  searchInput.focus();
                }
              }
            }, 100);
          });
        });

        // Ensure proper mobile behavior for contact links
        const contactLinks = document.querySelectorAll('a[href^="tel:"], a[href^="mailto:"]');
        contactLinks.forEach(link => {
          link.addEventListener('click', function(e) {
            // Let the browser handle the default behavior
            setTimeout(() => {
              if (window.location.href === this.href) {
                if (this.href.startsWith('tel:')) {
                  alert('Please call: ' + this.textContent.trim());
                } else if (this.href.startsWith('mailto:')) {
                  alert('Please email: ' + this.textContent.trim());
                }
              }
            }, 100);
          });
        });

        // Ensure external links open properly
        const externalLinks = document.querySelectorAll('a[target="_blank"]');
        externalLinks.forEach(link => {
          link.addEventListener('click', function(e) {
            if (!window.open(this.href, '_blank')) {
              window.location.href = this.href;
            }
          });
        });
      });
    </script>
  </body>
</html>
