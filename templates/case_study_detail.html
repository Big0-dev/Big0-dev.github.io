{% extends "base.html" %}

{% block title %}{{ current_case_studie.title }}{% endblock %}
{% block meta_description %}{{ current_case_studie.meta_description }}{% endblock %}
{% block canonical_path %}/case-studies/{{ current_case_studie.slug }}.html{% endblock %}

{% block custom_css %}
<link rel="stylesheet" href="{{ static }}/detail-pages.css">
{% endblock %}

{% block content %}
<!-- Case Study Hero -->
<section class="page-hero">
  <div class="container">
    <!-- Breadcrumbs -->
    <nav class="breadcrumbs mb-lg">
      <a href="{{ home }}" class="breadcrumb-link">Home</a>
      <span class="breadcrumb-separator">/</span>
      <a href="{{ case_studies }}" class="breadcrumb-link">Case Studies</a>
      <span class="breadcrumb-separator">/</span>
      <span class="breadcrumb-current">{{ current_case_studie.title }}</span>
    </nav>
    
    <div class="hero-content text-center max-w-3xl mx-auto">
      <h1 class="text-4xl font-bold mb-lg">{{ current_case_studie.title }}</h1>
      <div class="flex items-center justify-center gap-md">
        <span class="badge">{{ current_case_studie.frontmatter.industry | default('Technology') }}</span>
        <span class="badge badge-secondary">{{ current_case_studie.frontmatter.type | default('Case Study') }}</span>
        <span class="text-sm text-tertiary">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: inline-block; vertical-align: middle;">
            <circle cx="12" cy="12" r="10"/>
            <polyline points="12 6 12 12 16 14"/>
          </svg>
          <span class="reading-time">Calculating...</span>
        </span>
      </div>
    </div>
  </div>
</section>

<!-- Case Study Content -->
<section class="section">
  <div class="container">
    <div class="max-w-4xl mx-auto">
      
      <!-- Challenge and Solution -->
      {% if current_case_studie.frontmatter.challenge or current_case_studie.frontmatter.solution %}
      <div class="grid grid-2 gap-xl mb-3xl grid-mobile-1">
        {% if current_case_studie.frontmatter.challenge %}
        <div class="card p-xl">
          <div class="icon-container icon-lg icon-gradient mb-lg">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
              <line x1="12" y1="9" x2="12" y2="13"/>
              <line x1="12" y1="17" x2="12.01" y2="17"/>
            </svg>
          </div>
          <h3 class="text-lg font-semibold mb-md">The Challenge</h3>
          <p class="text-tertiary">{{ current_case_studie.frontmatter.challenge }}</p>
        </div>
        {% endif %}
        
        {% if current_case_studie.frontmatter.solution %}
        <div class="card p-xl">
          <div class="icon-container icon-lg icon-gradient mb-lg">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="9 11 12 14 22 4"/>
              <path d="M21 12v7a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h11"/>
            </svg>
          </div>
          <h3 class="text-lg font-semibold mb-md">Our Solution</h3>
          <p class="text-tertiary">{{ current_case_studie.frontmatter.solution }}</p>
        </div>
        {% endif %}
      </div>
      {% endif %}

      <!-- Results & Impact -->
      {% if current_case_studie.frontmatter.results %}
      <div class="section-header mb-xl">
        <h2 class="section-title">Results & Impact</h2>
      </div>
      <div class="grid grid-2 gap-xl mb-3xl grid-mobile-1">
        {% set results = current_case_studie.frontmatter.results.split(',') %}
        {% set descriptions = current_case_studie.frontmatter.result_descriptions.split(',') if current_case_studie.frontmatter.result_descriptions else [] %}
        {% for result in results %}
        <div class="card p-lg text-center">
          <div class="text-3xl font-bold text-gradient mb-sm">{{ result.strip() }}</div>
          {% if descriptions[loop.index0] %}
          <p class="text-tertiary text-sm">{{ descriptions[loop.index0].strip() }}</p>
          {% endif %}
        </div>
        {% endfor %}
      </div>
      {% endif %}

      <!-- Main Content -->
      <div class="detail-content mb-3xl">
        {{ current_case_studie.content_html | safe }}
      </div>

      <!-- Technologies Used -->
      {% if current_case_studie.frontmatter.technologies %}
      <div class="mb-3xl">
        <h3 class="text-lg font-semibold mb-lg">Technologies Used</h3>
        <div class="flex flex-wrap gap-sm">
          {% for tech in current_case_studie.frontmatter.technologies.split(',') %}
          <span class="badge badge-secondary">{{ tech.strip() }}</span>
          {% endfor %}
        </div>
      </div>
      {% endif %}

      <!-- Navigation -->
      <div class="text-center">
        <a href="../case-studies.html" class="btn btn-secondary">
          <svg class="mr-sm" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M19 12H5"/>
            <polyline points="12 19 5 12 12 5"/>
          </svg>
          Back to Case Studies
        </a>
      </div>
    </div>
  </div>
</section>

<!-- CTA Section -->
{% include 'cta.html' %}
{% endblock %}

{% block scripts %}
{{ super() }}
<script>
// Calculate reading time
document.addEventListener('DOMContentLoaded', function() {
  const content = document.querySelector('.detail-content');
  const readingTimeElement = document.querySelector('.reading-time');
  
  if (content && readingTimeElement) {
    // Get text content and count words
    const text = content.textContent || content.innerText;
    const words = text.trim().split(/\s+/).length;
    
    // Calculate reading time (200 words per minute average)
    const wordsPerMinute = 200;
    const readingTime = Math.ceil(words / wordsPerMinute);
    
    // Update the display
    readingTimeElement.textContent = `${readingTime} min read`;
  }
});
</script>
{% endblock %}